angular.module("starter",["ionic","login.controllers","starter.controllers","starter.home","pascalprecht.translate","ngResource","firebase","ngCordova"]).run(["$firebaseAuth","$ionicSlideBoxDelegate","$sce","$ionicPlatform","$state","$rootScope","$timeout","$interval","$cordovaDevice","$firebaseObject","FirebaseConfig","$cordovaGlobalization","$translate","$cordovaStatusbar","$ionicPopup",function(e,o,n,a,i,t,r,l,u,c,s,d,g,f,p){t.spinner=!1,g.use("en"),t.goHomeAndAnim=function(){i.go("tabs.home",null,{reload:!0,notify:!0})},t.goHelp=function(){i.go("tabs.help")},t.goAccount=function(){i.go("tabs.account")};var v=new Firebase(s.root_url);t.authObj=e(v),t.authObj.$onAuth(function(e){null===e||(console.log("Logged in as",e.uid),i.go("tabs.home"))}),t.unAuth=function(){var e=new Firebase(s.root_url);e.unauth(),t.privateData=null,i.go("login")},t.onAuthUser=function(){function e(e){switch(e.provider){case"password":return e.password.email.replace(/@.*/,"");case"twitter":return e.twitter.displayName;case"facebook":return e.facebook.displayName;case"google":return e.google.displayName}}function o(e){switch(e.provider){case"password":return e.password.email;case"twitter":return e.twitter.displayName;case"facebook":return e.facebook.email;case"google":return e.google.email}}var n=new Firebase(s.users_url),a=function(n){if(n){console.log(s.users_url+n.uid);var a=new Firebase(s.root_url+n.uid);r(function(){t.authData=n,"twitter"==n.provider?t.ownerPictureUrl=n.twitter.cachedUserProfile.profile_image_url:"facebook"==n.provider&&(t.ownerPictureUrl=n.facebook.cachedUserProfile.picture.data.url),a.once("value",function(i){i.val()?a.update({name:e(n),email:o(n)?o(n):null,picture:t.ownerPictureUrl,lastConnexionDate:Firebase.ServerValue.TIMESTAMP}):a.set({provider:n.provider,name:e(n),email:o(n)?o(n):null,picture:t.ownerPictureUrl,accountCreationDate:Firebase.ServerValue.TIMESTAMP})})})}};n.onAuth(a)},t.register=function(e,o){t.spinner=!0,t.authObj.$createUser({email:e,password:o}).then(function(n){return console.log("User "+n.uid+" created successfully!"),t.login_message="your account has been created, you'll now be connected automatically",t.authObj.$authWithPassword({email:e,password:o})})["catch"](function(n){"INVALID_ARGUMENTS"==n.code?t.login_message="invalid credentials":"INVALID_USER"==n.code?t.login_message="invalid_user":"INVALID_EMAIL"==n.code?t.login_message="The email provided is invalid":"EMAIL_TAKEN"==n.code?(t.login_message="The email provided is already taken",t.userLogin(e,o)):n&&(t.login_message="Please verify your informations"),t.spinner=!1})},a.ready(function(){window.Connection&&(navigator.connection.type==Connection.NONE&&p.confirm({title:"No Internet Connection",content:"Sorry, no Internet connectivity detected. Please reconnect and try again."}).then(function(e){e||ionic.Platform.exitApp()}),t.online=navigator.onLine?"online":"offline",t.$apply(),window.addEventListener?(window.addEventListener("online",function(){t.online="online",t.$apply()},!0),window.addEventListener("offline",function(){t.online="offline",t.$apply()},!0)):(document.body.ononline=function(){t.online="online",t.$apply()},document.body.onoffline=function(){t.online="offline",t.$apply()})),window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&f.style(),window.navigator.language?(t.globalization={value:window.navigator.language},g.use(t.globalization.value)):window.navigator.userLanguage&&(t.globalization={value:window.navigator.userLanguage},g.use(t.globalization.value)),t.device=u.getDevice(),d.getPreferredLanguage().then(function(e){t.globalization=e,t.globalization.value=t.globalization.value.substring(0,2),g.use(t.globalization.value)},function(e){t.globalization=e})},!1)}]);